<section>
    <div id="startButton">
        <button type="button" id="startButton">Start Quiz!</button>
    </div>
    <div class="columns is-multiline" id="gameDisplay">
        <!-- question counter -->
        <div class="column is-full">
            <h1 class="question-counter">Q: <span id="currentCount" class="current-count"></span> of 5</h1>
        </div>
        <div class="column is-full">
            <div class="columns is-vcentered">
                <!-- image -->
                <div class="column">
                    <div id = "questionImg" class="question-Img" ></div>
                </div>
                <!-- question text -->
                <div class="column question-response-column">
                    <div id="questionText" class="question-text"></div>
                    <input id="userResponse" class="input user-response is-warning" type="text"
                        placeholder="your answer">
                    <button id="guessButton" class="guess-button button is-large" data-id="0">make a guess!</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modalContainer" class="modal is-centered">
        <div class="modal-background"></div>
        <div class="modal-content">

            <div class="card">
                <div class="card-content">
                    <div class="content">
                        <p class="modal-text">Lorem ipsum dolor sit amet consectetur adipisicing elit. Odio doloribus
                            atque enim aut voluptatibus nemo sed minus, natus nobis neque doloremque consequatur dolores
                            dolorem. Nostrum corporis consequatur amet sit accusantium?</p>
                        <button id="modalButton" class="button is-warning is-large">next</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>

<script>
    
    $(document).ready(function () {

        //document.getElementById("gameDisplay").style.display = "none";
        
        var questionText = document.createElement("p");
        var questionImg = document.createElement("img");
        var userResponse = $("#user-response");
        var questionsAnswered;
        let questions = [];
        let questionsIndex = 0;

        function startQuiz(){
            questionsAnswered = 0;
            //$(document).on("click", "#startButton", displayQuestion);
            getQuestions();
        }

        function getQuestions(){
            $.get("/api/questions/", function (data) {
                questions = data;
                showQuestion();
            });
        }

        function showQuestion() {
            questionText.innerHTML = questions[questionsIndex].question;
            questionImg.src = questions[questionsIndex].image_url;
            document.getElementById("questionText").appendChild(questionText);
            document.getElementById("questionImg").appendChild(questionImg);
            document.getElementById("currentCount").innerText = (questionsIndex + 1).toString();
            $("#guessButton").attr("data-id", questions[questionsIndex].id);
        }

        $(document).on("click", "#guessButton", function () {
            const questionId = $(this).attr("data-id");
            var newAnswer = {
                UserId: {{user.id}},
                QuestionId: questionId,
                user_response: document.getElementById("userResponse").value,
                answer_score: 100
            };
            console.log(newAnswer);
            postAnswer(newAnswer);
        })

        function postAnswer(answer){
            $.ajax({
            method: "POST",
            url: "/api/answers",
            data: answer
            })
            .then(function() {
                console.log("answer posted");
                if (questionsIndex === questions.length){
                    showScore();
                }
                else{
                    questionsIndex++;
                    showQuestion();
                }
            });
        }

        function showScore(){
            alert("this function will show your score and redirect you back to home page")
        }

        startQuiz();

    });

    // JAVASCRIPT FOR "/game" game page HERE!

    /*// make modal appear when click on button
    $("#guessButton").on("click", function (event) {
        event.preventDefault();
        $("#modalContainer").addClass("is-active");
    });
    // make modal disappear when click on button
    $("#modalButton").on("click", function (event) {
        event.preventDefault();
        $("#modalContainer").removeClass("is-active");
    });*/

</script>